<br />
<br />
<br />


<div class="profile-wrapper">
  <!-- ØªÙ… Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¹Ø¨Ø± Ø§Ù„Ù€ CSS -->
  <video autoplay loop muted class="background-video">
    <source src="/src/assets/vedio/flowersFall.mp4" type="video/mp4">
  </video>

  <!-- Ø¥Ø¶Ø§ÙØ© Ø²Ø®Ø§Ø±Ù Ø²Ù‡Ø±ÙŠØ© -->
  <!--<div class="floral-decor top-left">ğŸŒ¸</div>
  <div class="floral-decor bottom-right">ğŸŒº</div>-->

  <div class="profile-card">
    <div *ngIf="user">
      <div class="profile-image">
        <img [src]="user.Img || 'assets/floral-avatar.png'" alt="Profile Image" width="150" height="150">
        <div class="flower-crown">ğŸŒ¿</div>
      </div>

      <h2>Welcome, {{ user.Name }}! <span class="flower-emoji">ğŸŒ¼</span></h2>

      <!-- ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø¯ÙˆÙ† Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª -->
      <div class="detail-box">
        <p><strong>Email:</strong> {{ user.Email }}</p>
        <p><strong>Phone Number:</strong> {{ user.PhoneNum }}</p>
        <p><strong>Gender:</strong> {{ user.Gender }}</p>
        <p><a routerLink="/Voucher" class="surprise-link">ğŸ Open Your Surprise Box</a></p>
      </div>

      <!-- ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø²Ø±Ø§Ø± -->
      <div class="buttons-container">
        <a routerLink="/history" class="history-btn"> View History</a>
        <button class="edit-btn" data-bs-toggle="modal" data-bs-target="#editProfileModal" (click)="openCameraModal()">
          Edit Profile
        </button>
      </div>
    </div>
  </div>

  <!-- ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ -->
  <div class="modal fade" id="editProfileModal" tabindex="-1" aria-labelledby="editProfileLabel" aria-hidden="true">
    <div class="modal-dialog modal-floral">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Edit Your Garden</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form #editForm="ngForm" (ngSubmit)="updateProfile()">
            <!-- ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª Ø¨Ø¯ÙˆÙ† Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª -->
            <div class="input-group">
              <input type="text" class="form-input" [(ngModel)]="editableUser.Name" name="Name" required placeholder="Your Blooming Name">
            </div>

            <div class="input-group">
              <input type="email" class="form-input" [(ngModel)]="editableUser.Email" name="Email" required placeholder="Floral Email">
            </div>

            <div class="input-group">
              <input type="number" class="form-input" [(ngModel)]="editableUser.PhoneNum" name="PhoneNum" required placeholder="Rose Phone Number">
            </div>

            <!-- ØµÙˆØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
            <div class="container mt-5">
              <h2>Upload Your Profile Image</h2>
              <div class="mb-3">
                <input type="file" (change)="onImageSelected($event)" class="form-control" accept="image/*">
              </div>

              <button (click)="selectedFile && uploadImage(selectedFile)" class="btn btn-primary mb-3" [disabled]="loading || !selectedFile">
                {{ loading ? 'Uploading...' : 'Upload Image' }}
              </button>

              <div *ngIf="uploadedImageUrl" class="mt-3">
                <div class="mt-2">
                  <img [src]="uploadedImageUrl" alt="Uploaded Image" class="img-thumbnail" width="200">
                </div>
              </div>
            </div>

            <!-- Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ÙˆØ§Ù„ØªÙ‚Ø§Ø· ØµÙˆØ±Ø© -->
            <div class="camera-container mt-5">
              <h2>Or Capture with Camera</h2>

              <!-- Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± -->
              <div *ngIf="showVideo" class="mb-3">
                <video id="videoElement" autoplay playsinline width="100%" height="250" class="rounded border"></video>
                <button type="button" class="btn btn-warning mt-2" (click)="captureImage()">ğŸ“¸ Capture Image</button>
              </div>

              <!-- Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ù„ØªÙ‚Ø·Ø© -->
              <div *ngIf="capturedImage" class="text-center">
                <img [src]="capturedImage" alt="Captured" class="img-thumbnail mt-2" width="200">
                <div class="mt-2">
                  <button type="button" class="btn btn-danger me-2" (click)="deleteImage()">âŒ Delete</button>
                  <button type="button" class="btn btn-success" (click)="uploadCapturedImage()">â¬†ï¸ Upload</button>
                </div>
              </div>
            </div>

            <button type="submit" class="submit-btn mt-4">Save Changes</button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
